clear
clc
global um Ks Yxs Yxp

um = 0.3929;
Ks = 215.2;
Yxs = 0.046;
Yps = 0.424;
Yxp = Yxs/Yps;

ci = [0.89,106.9,0];
tspan = linspace(0,40);
[t,x] = ode45('bath_reactor_sac',tspan,ci);

exp1 = [0	0.89	106.90	0.00
        1	0.89	106.90	0.00
        2	0.89	106.90	0.00
        3	0.91	106.30	0.04
        4	0.97	105.60	0.68
        5	1.07	104.60	1.59
        6	1.19	103.10	2.76
        7	1.35	101.10	4.17
        8	1.52	98.60	5.80
        9	1.73	95.60	7.65
        10	1.95	91.90	9.68
        11	2.20	87.70	11.90
        12	2.46	82.90	14.20
        13	2.73	77.60	16.70
        14	3.01	71.90	19.20
        15	3.31	65.70	21.80
        16	3.60	59.20	24.40
        17	3.89	52.50	27.00
        18	4.18	45.70	29.60
        19	4.45	38.90	32.10
        20	4.71	32.20	34.40
        21	4.95	25.90	36.60
        22	5.17	20.00	38.60
        23	5.35	14.80	40.30
        24	5.49	10.50	41.70
        25	5.57	7.40	42.70
        26	5.57	7.00	42.80
        27	5.57	7.00	42.80
        28	5.57	7.00	42.80];

figure
hold on
scatter(exp1(:,1),exp1(:,2),'MarkerEdgeColor','b');
scatter(exp1(:,1),exp1(:,3),'MarkerEdgeColor','g');
scatter(exp1(:,1),exp1(:,4),'MarkerEdgeColor','r');
plot(t,x);xlabel('t(h)');ylabel('X,S,P(g/L)');legend('X_e_x_p','S_e_x_p','P_e_x_p','X','S','P');
hold off

exp2 = [106.90	0.000
        106.90	0.000
        106.90	0.011
        106.30	0.044
        105.60	0.082
        104.60	0.103
        103.10	0.118
        101.10	0.122
        98.60	0.125
        95.60	0.124
        91.90	0.121
        87.70	0.116
        82.90	0.108
        77.60	0.101
        71.90	0.096
        65.70	0.089
        59.20	0.081
        52.50	0.075
        45.70	0.067
        38.90	0.060
        32.20	0.053
        25.90	0.046
        20.00	0.039
        14.80	0.030
        10.50	0.020
        7.40	0.007
        7.00	0.000
        7.00    0.000
        7.00	0.000];

ux = um*x(:,2)./(Ks+x(:,2));

figure
hold on
scatter(exp2(:,1),exp2(:,2),'MarkerEdgeColor','r');
plot(x(:,2),ux);xlabel('S(g/L)');ylabel('\mu_X(h^-^1)');legend('\mu_X_e_x_p','\mu_X');
hold off